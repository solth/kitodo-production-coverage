


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > SecurityAccessService</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.kitodo.production.services.security</a>
</div>

<h1>Coverage Summary for Class: SecurityAccessService (org.kitodo.production.services.security)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SecurityAccessService</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    5,5%
  </span>
  <span class="absValue">
    (6/110)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    15,8%
  </span>
  <span class="absValue">
    (21/133)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * (c) Kitodo. Key to digital objects e. V. &lt;contact@kitodo.org&gt;
&nbsp; *
&nbsp; * This file is part of the Kitodo project.
&nbsp; *
&nbsp; * It is licensed under GNU General Public License version 3 or later.
&nbsp; *
&nbsp; * For the full copyright and license information, please read the
&nbsp; * GPL3-License.txt file that was distributed with this source code.
&nbsp; */
&nbsp;
&nbsp;package org.kitodo.production.services.security;
&nbsp;
&nbsp;import java.util.List;
&nbsp;import java.util.Objects;
&nbsp;
&nbsp;import org.kitodo.data.database.beans.Project;
&nbsp;import org.kitodo.data.database.beans.User;
&nbsp;import org.kitodo.data.exceptions.DataException;
&nbsp;import org.kitodo.production.security.SecurityUserDetails;
&nbsp;import org.kitodo.production.services.ServiceManager;
&nbsp;import org.kitodo.security.SecurityAccess;
&nbsp;import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
&nbsp;import org.springframework.security.core.Authentication;
&nbsp;import org.springframework.security.core.context.SecurityContextHolder;
&nbsp;
<b class="fc">&nbsp;public class SecurityAccessService extends SecurityAccess {</b>
&nbsp;
<b class="fc">&nbsp;    private static volatile SecurityAccessService instance = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Return singleton variable of type SecurityAccessService.
&nbsp;     *
&nbsp;     * @return unique instance of SecurityAccessService
&nbsp;     */
&nbsp;    public static SecurityAccessService getInstance() {
<b class="fc">&nbsp;        SecurityAccessService localReference = instance;</b>
<b class="fc">&nbsp;        if (Objects.isNull(localReference)) {</b>
<b class="fc">&nbsp;            synchronized (SecurityAccessService.class) {</b>
<b class="fc">&nbsp;                localReference = instance;</b>
<b class="fc">&nbsp;                if (Objects.isNull(localReference)) {</b>
<b class="fc">&nbsp;                    localReference = new SecurityAccessService();</b>
<b class="fc">&nbsp;                    instance = localReference;</b>
&nbsp;                }
<b class="fc">&nbsp;            }</b>
&nbsp;        }
<b class="fc">&nbsp;        return localReference;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getClientId() {
<b class="fc">&nbsp;        return ServiceManager.getUserService().getSessionClientId();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Get the current authenticated user of current threads security context.
&nbsp;     *
&nbsp;     * @return the SecurityUserDetails object or null if no user is authenticated
&nbsp;     */
&nbsp;    public SecurityUserDetails getAuthenticatedSecurityUserDetails() {
<b class="fc">&nbsp;        if (isAuthenticated()) {</b>
<b class="fc">&nbsp;            Object principal = getCurrentAuthentication().getPrincipal();</b>
<b class="fc">&nbsp;            if (principal instanceof SecurityUserDetails) {</b>
<b class="fc">&nbsp;                return (SecurityUserDetails) principal;</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if there is currently an authenticated user.
&nbsp;     *
&nbsp;     * @return true if there is currently an authenticated user
&nbsp;     */
&nbsp;    public boolean isAuthenticated() {
<b class="fc">&nbsp;        Authentication currentAuthentication = getCurrentAuthentication();</b>
<b class="fc">&nbsp;        if (Objects.nonNull(currentAuthentication)) {</b>
<b class="fc">&nbsp;            return currentAuthentication.isAuthenticated();</b>
&nbsp;        }
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Update Authentication object of current threads security context
&nbsp;     * after changing current parameters of authenticated user.
&nbsp;     *
&nbsp;     * @param updatedUser as Object of the updated authenticated user
&nbsp;     */
&nbsp;    public void updateAuthentication(User updatedUser) {
<b class="nc">&nbsp;        SecurityUserDetails userDetails = new SecurityUserDetails(updatedUser);</b>
<b class="nc">&nbsp;        userDetails.setSessionClient(ServiceManager.getUserService().getSessionClientOfAuthenticatedUser());</b>
<b class="nc">&nbsp;        Authentication authentication = new UsernamePasswordAuthenticationToken(userDetails, userDetails.getPassword(),</b>
<b class="nc">&nbsp;                userDetails.getAuthorities());</b>
<b class="nc">&nbsp;        SecurityContextHolder.getContext().setAuthentication(authentication);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the batch.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the batch
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddBatch() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addBatch&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the process.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the process
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddProcess() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addProcess&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the project.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the project
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddProject() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addProject&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the template.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the template
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddTemplate() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addTemplate&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the workflow.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the workflow
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddWorkflow() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addWorkflow&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the docket.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the docket
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddDocket() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addDocket&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the ruleset.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the ruleset
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddRuleset() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addRuleset&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add new import configuration.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add new import configuration.
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddImportConfiguration() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addImportConfiguration&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add new mapping file.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add new mapping file.
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddMappingFile() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;addMappingFile&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the user.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the user
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddUser() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;addUser&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the role.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the role
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddRole() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;addRole&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the client.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddClient() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;addClient&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to add the authority.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to add the authority
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddAuthority() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;addAuthority&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to add anything on user page. It returns
&nbsp;     * true if user has at least one of below given authorities.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;addUser&#39; or &#39;addRole&#39; or &#39;addClient&#39; or
&nbsp;     *         &#39;addLdapGroup&#39; or &#39;addLdapServer&#39; globally or for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddOnUserPage() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobalOrForClient(&quot;addUser, addRole, addClient, addLdapGroup, addLdapServer&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to add anything on project page. It
&nbsp;     * returns true if user has at least one of below given authorities.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;addProject&#39; or &#39;addTemplate&#39; or
&nbsp;     *         &#39;addWorkflow&#39; or &#39;addDocket&#39; or &#39;addRuleset&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToAddOnProjectPage() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;addProject, addTemplate, addWorkflow, addDocket, addRuleset&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the batch.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the batch
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteBatch() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteBatch&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the process.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the process
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteProcess() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteProcess&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the task.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the task
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteTask() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteTask&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the project.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the project
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteProject() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteProject&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the template.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the template
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteTemplate() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteTemplate&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the workflow.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the workflow
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteWorkflow() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteWorkflow&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the docket.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the docket
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteDocket() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteDocket&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the ruleset.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the ruleset
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteRuleset() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteRuleset&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete import configuration.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the import configuration
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteImportConfiguration() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteImportConfiguration&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete mapping file object.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the mapping file object
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteMappingFile() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;deleteMappingFile&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the user.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the user
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteUser() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;deleteUser&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the role.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the role
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteRole() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;deleteRole&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the client.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteClient() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;deleteClient&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete the authority.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete the authority
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteAuthority() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;deleteAuthority&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the task.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the task
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditTask() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editTask&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the task.
&nbsp;     *
&nbsp;     * @param taskId the specific taskId
&nbsp;     * @return true if the current user has the authority to edit the task
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditTask(int taskId) throws DataException {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editTask&quot;) &amp;&amp; hasAuthorityForTask(taskId);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the batch.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the batch
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditBatch() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editBatch&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the process.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the process
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProcess() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProcess&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the process.
&nbsp;     *
&nbsp;     * @param processId
&nbsp;     *            the specific processId
&nbsp;     * @return true if the current user has the authority to edit the process
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProcess(int processId) throws DataException {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProcess&quot;) &amp;&amp; hasAuthorityForProcess(processId);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the project.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the project
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProject() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProject&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the project.
&nbsp;     *
&nbsp;     * @param projectId
&nbsp;     *            the specific projectId
&nbsp;     * @return true if the current user has the authority to edit the project
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProject(int projectId) {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProject&quot;) &amp;&amp; hasAuthorityForProject(projectId);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the template.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the template
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditTemplate() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editTemplate&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the workflow.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the workflow
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditWorkflow() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editWorkflow&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the docket.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the docket
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditDocket() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editDocket&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the ruleset.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the ruleset
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditRuleset() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editRuleset&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit import configuration.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit import configuration
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditImportConfiguration() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editImportConfiguration&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit import configuration.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit import configuration
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditMappingFile() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editMappingFile&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if the current user has the authority to edit the user.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the user
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditUser() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;editUser&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if the current user has the authority to unassign all tasks in progress of a user.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to unassign all tasks in progress of a user
&nbsp;     */
&nbsp;    public boolean hasAuthorityToUnassignTasks() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;unassignTasks&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to upload media in metadataeditor.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to to upload media in metadataeditor
&nbsp;     */
&nbsp;    public boolean hasAuthorityToUploadMedia() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;uploadMedia&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if the current user has the authority to edit the role.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the role
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditRole() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;editRole&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the client.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditClient() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;editClient&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the authority.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the authority
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditAuthority() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;editAuthority&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the index.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the index
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditIndex() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;editIndex&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to export process.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to export process
&nbsp;     */
&nbsp;    public boolean hasAuthorityToExportProcess() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;exportProcess&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the process. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the process
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProcess() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewProcess, addProcess, editProcess&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the process. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @param processId
&nbsp;     *            the specific processId
&nbsp;     * @return true if the current user has the authority to view the process
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProcess(int processId) throws DataException {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewProcess, addProcess, editProcess&quot;) &amp;&amp; hasAuthorityForProcess(processId);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the project. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the project
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProject() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewProject, addProject, editProject&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the project. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @param projectId
&nbsp;     *            the specific projectId
&nbsp;     * @return true if the current user has the authority to view the project
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProject(int projectId) {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewProject, addProject, editProject&quot;) &amp;&amp; hasAuthorityForProject(projectId);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the template. Add and
&nbsp;     * edit authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the template
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewTemplate() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewTemplate, addTemplate, editTemplate&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the workflow. Add and
&nbsp;     * edit authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the workflow
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewWorkflow() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewWorkflow, addWorkflow, editWorkflow&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the docket. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the docket
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewDocket() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewDocket, addDocket, editDocket&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the ruleset. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the ruleset
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewRuleset() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewRuleset, addRuleset, editRuleset&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view import configuration. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view import configuration
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewImportConfiguration() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewImportConfiguration, editImportConfiguration, addImportConfiguration&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view mapping file.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view mapping file
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewMappingFile() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;viewMappingFile, editMappingFile, addMappingFile&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the user. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the user
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewUser() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobalOrForClient(&quot;viewUser, addUser, editUser&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to change the user config. It is
&nbsp;     * true if current user is logged user.
&nbsp;     *
&nbsp;     * @param userId
&nbsp;     *            id of the viewed user
&nbsp;     * @return true if the current user has the authority to change the user config
&nbsp;     */
&nbsp;    public boolean hasAuthorityToConfigUser(int userId) {
<b class="nc">&nbsp;        return ServiceManager.getUserService().getAuthenticatedUser().getId().equals(userId);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the role. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the role
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewRole() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobalOrForClient(&quot;viewRole, addRole, editRole&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the client. Add and edit
&nbsp;     * authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewClient() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobalOrForClient(&quot;viewClient, addClient, editClient&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the authority. Add and
&nbsp;     * edit authorities include also view.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the authority
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewAuthority() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobalOrForClient(&quot;viewAuthority, addAuthority, editAuthority&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view task list. It returns true if
&nbsp;     * user has &quot;viewAllTasks&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllTasks&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewTaskList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllTasks&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view batch list. It returns true if
&nbsp;     * user has &quot;viewAllBatches&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllBatches&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewBatchList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllBatches&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view process list. It returns true if
&nbsp;     * user has &quot;viewAllProcesses&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllProcesses&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProcessList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllProcesses&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view project list. It returns true if
&nbsp;     * user has &quot;viewAllProjects&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllProjects&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProjectList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllProjects&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view template list. It returns true if
&nbsp;     * user has &quot;viewAllTemplates&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllTemplates&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewTemplateList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllTemplates&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view workflow list. It returns true if
&nbsp;     * user has &quot;viewAllWorkflows&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllWorkflows&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewWorkflowList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllWorkflows&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view docket list. It returns true if
&nbsp;     * user has &quot;viewAllDockets&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllDockets&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewDocketList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllDockets&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view ruleset list. It returns true if
&nbsp;     * user has &quot;viewAllRulesets&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllRulesets&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewRulesetList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllRulesets&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view import configuration list. It returns true if
&nbsp;     * user has &quot;viewAllImportConfigurations&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllImportConfigurations&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewImportConfigurationList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllImportConfigurations&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view mapping file list. It returns true if
&nbsp;     * user has &quot;viewAllMappingFiles&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllMappingFiles&#39; for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewMappingFileList() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewAllMappingFiles&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view user list. It returns true if
&nbsp;     * user has &quot;viewAllUsers&quot; authority globally or for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllUsers&#39; globally or for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewUserList() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;viewAllUsers&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view role list. It returns true if
&nbsp;     * user has &quot;viewAllRoles&quot; authority globally or for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllRoles&#39; globally or for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewRoleList() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;viewAllRoles&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view client list. It returns true if
&nbsp;     * user has &quot;viewAllClients&quot; authority for client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllClients&#39; globally or for client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewClientList() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;viewAllClients&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has global authority to view authority list. It returns
&nbsp;     * true if user has &quot;viewAllAuthorities&quot; authority globally.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllAuthorities&#39; globally
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewAuthorityList() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;viewAllAuthorities&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view LDAP group list. It returns true
&nbsp;     * if user has &quot;viewAllLdapGroups&quot; authority globally.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllLdapGroups&#39; globally
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewLdapGroupList() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;viewAllLdapGroups&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view LDAP server list. It returns true
&nbsp;     * if user has &quot;viewAllLdapServers&quot; authority globally.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllLdapServers&#39; globally
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewLdapServerList() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;viewAllLdapServers&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if current user has global authority for add or edit role. If yes,
&nbsp;     * current client is not assigned to created or edited role.
&nbsp;     *
&nbsp;     * @return true if current user has global authority for add or edit role
&nbsp;     */
&nbsp;    public boolean hasAuthorityGlobalToAddOrEditRole() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobal(&quot;addRole, editRole&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has global authority to view role list. It returns true
&nbsp;     * if user has &quot;viewAllRoles&quot; authority globally.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllRoles&#39; globally
&nbsp;     */
&nbsp;    public boolean hasAuthorityGlobalToViewRoleList() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;viewAllRoles&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current user has authority to view user list. It returns true if
&nbsp;     * user has &quot;viewAllUsers&quot; authority globally.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;viewAllUsers&#39; globally
&nbsp;     */
&nbsp;    public boolean hasAuthorityGlobalToViewUserList() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;viewAllUsers&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if current usr has authority to configure list views. It returns true
&nbsp;     * if the user has &quot;configureColumns&quot; authority globally or for a client.
&nbsp;     *
&nbsp;     * @return true if user has authority &#39;configureColumns&#39; globally or for a
&nbsp;     *         client
&nbsp;     */
&nbsp;    public boolean hasAuthorityToConfigureColumns() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;configureColumns&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the process metadata.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the process
&nbsp;     *         metadata
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProcessMetaData() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProcessMetaData&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the process metadata.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the process
&nbsp;     *         metadata
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProcessMetaData() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewProcessMetaData&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the process structure
&nbsp;     * data.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the process
&nbsp;     *         structure data
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProcessStructureData() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProcessStructureData&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the process structure
&nbsp;     * data.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the process
&nbsp;     *         structure data
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProcessStructureData() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewProcessStructureData&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the process images.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the process images
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProcessImages() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProcessImages&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the process images.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the process images
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProcessImages() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewProcessImages&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to edit the process pagination.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to edit the process pagination
&nbsp;     */
&nbsp;    public boolean hasAuthorityToEditProcessPagination() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;editProcessPagination&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the process pagination.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the process pagination
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewProcessPagination() {
<b class="nc">&nbsp;        return hasAuthorityForClient(&quot;viewProcessPagination&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the database statistics.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view database statistics
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewDatabaseStatistic() {
<b class="nc">&nbsp;        return hasAuthorityGlobal(&quot;viewDatabaseStatistic&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the index page.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the index page
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewIndexPage() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobal(&quot;viewIndex, editIndex&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the task manager page.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the task manager page
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewTaskManagerPage() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobal(&quot;viewTaskManager&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the terms page.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the terms page
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewTermsPage() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobal(&quot;viewTerms&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to view the migration page.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to view the migration page
&nbsp;     */
&nbsp;    public boolean hasAuthorityToViewMigrationPage() {
<b class="nc">&nbsp;        return hasAnyAuthorityGlobal(&quot;viewMigration&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    private boolean hasAuthorityForTask(int taskId) throws DataException {
<b class="nc">&nbsp;        Integer processId = ServiceManager.getTaskService().findById(taskId).getProcess().getId();</b>
<b class="nc">&nbsp;        return hasAuthorityForProcess(processId);</b>
&nbsp;    }
&nbsp;
&nbsp;    private boolean hasAuthorityForProcess(int processId) throws DataException {
<b class="nc">&nbsp;        Integer projectId = processId == 0 ? 0</b>
<b class="nc">&nbsp;                : ServiceManager.getProcessService().findById(processId).getProject().getId();</b>
<b class="nc">&nbsp;        return hasAuthorityForProject(projectId);</b>
&nbsp;    }
&nbsp;
&nbsp;    private boolean hasAuthorityForProject(Integer projectId) {
<b class="nc">&nbsp;        List&lt;Project&gt; projects = ServiceManager.getUserService().getCurrentUser().getProjects();</b>
<b class="nc">&nbsp;        return projects.stream().anyMatch(project -&gt; project.getId().equals(projectId)) || projectId == 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to delete media in metadata editor.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to delete media in metadata editor
&nbsp;     */
&nbsp;    public boolean hasAuthorityToDeleteMedia() {
<b class="nc">&nbsp;        return hasAuthorityGlobalOrForClient(&quot;deleteMedia&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Check if the current user has the authority to run Kitodo scripts.
&nbsp;     *
&nbsp;     * @return true if the current user has the authority to run Kitodo scripts.
&nbsp;     */
&nbsp;    public boolean hasAuthorityToRunKitodoScripts() {
<b class="nc">&nbsp;        return hasAnyAuthorityForClient(&quot;runKitodoScript&quot;);</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-12 13:55</div>
</div>
</body>
</html>
